(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{634:(e,t,r)=>{Promise.resolve().then(r.bind(r,3067))},3067:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var n=r(5155),s=r(2115),l=r(9911),i=r(2108);let a=()=>new Promise(e=>{var t;if(window.YT){e();return}let r=document.createElement("script");r.src="https://www.youtube.com/iframe_api";let n=document.getElementsByTagName("script")[0];null===(t=n.parentNode)||void 0===t||t.insertBefore(r,n),window.onYouTubeIframeAPIReady=()=>{e()}}),c=(0,s.forwardRef)((e,t)=>{let{videoId:r,onStateChange:l,onError:c,onReady:o,autoplay:d=!0}=e,u=(0,s.useRef)(null),x=(0,s.useRef)(null),[m,p]=(0,s.useState)(!1),{data:h}=(0,i.useSession)();return(0,s.useImperativeHandle)(t,()=>({playVideo:()=>{u.current&&m&&u.current.playVideo()},pauseVideo:()=>{u.current&&m&&u.current.pauseVideo()},getCurrentTime:()=>u.current&&m&&u.current.getCurrentTime()||0,getDuration:()=>u.current&&m&&u.current.getDuration()||0})),(0,s.useEffect)(()=>{if(!r)return;let e=!0;return(async()=>{try{if(await a(),!e||!x.current||!window.YT)return;u.current&&(u.current.destroy(),u.current=null),u.current=new window.YT.Player(x.current,{height:"100%",width:"100%",videoId:r,playerVars:{autoplay:+!!d,controls:1,disablekb:1,modestbranding:1,rel:0,iv_load_policy:3,fs:0},events:{onReady:()=>{e&&(p(!0),o&&o())},onStateChange:t=>{e&&l&&l(t.data)},onError:t=>{e&&c&&c(t.data)}}})}catch(e){console.error("Error initializing YouTube player:",e)}})(),()=>{if(e=!1,u.current){try{u.current.destroy()}catch(e){console.error("Error destroying player:",e)}u.current=null}}},[r]),(0,n.jsxs)("div",{className:"relative w-full",style:{aspectRatio:"16/9"},children:[(0,n.jsx)("div",{className:"absolute inset-0 rounded-xl overflow-hidden shadow-lg",ref:x}),!m&&(0,n.jsx)("div",{className:"absolute inset-0 bg-pink-light/50 flex items-center justify-center rounded-xl",children:(0,n.jsx)("div",{className:"w-12 h-12 border-4 border-pink-primary border-t-transparent rounded-full animate-spin"})})]})});c.displayName="YouTubePlayer";var o=r(1910),d=function(e){return e[e.UNSTARTED=-1]="UNSTARTED",e[e.ENDED=0]="ENDED",e[e.PLAYING=1]="PLAYING",e[e.PAUSED=2]="PAUSED",e[e.BUFFERING=3]="BUFFERING",e[e.CUED=5]="CUED",e}(d||{});function u(e){let{currentSong:t={title:"No song selected",videoId:""},nextSong:r={title:"No upcoming songs"},onPlay:i=()=>{},onPause:a=()=>{},onNext:d=()=>{},onPrevious:u=()=>{}}=e,[x,m]=(0,s.useState)(!1),[p,h]=(0,s.useState)(0),[g,f]=(0,s.useState)(!1),y=(0,s.useRef)(null),j=(0,s.useRef)(null);(0,s.useEffect)(()=>()=>{y.current&&clearInterval(y.current)},[]),(0,s.useEffect)(()=>{h(0),f(!1),y.current&&(clearInterval(y.current),y.current=null)},[t.videoId]);let v=()=>{y.current&&clearInterval(y.current),y.current=setInterval(()=>{if(j.current){let e=j.current,t=e.getDuration?e.getDuration():0,r=e.getCurrentTime?e.getCurrentTime():0;t>0&&h(r/t*100)}},1e3)},b=()=>{y.current&&(clearInterval(y.current),y.current=null)};return(0,n.jsx)("div",{className:"card w-full max-w-lg mx-auto p-6",children:(0,n.jsxs)("div",{className:"flex flex-col items-center",children:[t.videoId?(0,n.jsx)("div",{className:"w-full mb-4",children:(0,n.jsx)(c,{videoId:t.videoId,onStateChange:e=>{switch(e){case 1:m(!0),v();break;case 2:m(!1),b();break;case 0:m(!1),b(),h(0),d()}},onError:e=>{console.error("YouTube player error:",e),(150===e||100===e)&&setTimeout(d,1e3)},onReady:()=>{f(!0),o.R.playSong(t.videoId)},autoplay:!0,ref:j})}):(0,n.jsx)("div",{className:"w-48 h-48 rounded-xl bg-pink-light flex items-center justify-center mb-4",children:(0,n.jsx)("span",{className:"text-pink-primary text-5xl",children:"\uD83C\uDFB5"})}),(0,n.jsx)("h2",{className:"text-2xl font-bold text-pink-accent mb-1",children:t.title}),t.artist&&(0,n.jsx)("p",{className:"text-lg text-pink-dark mb-4",children:t.artist}),(0,n.jsx)("div",{className:"w-full bg-pink-light rounded-full h-2 mb-6",children:(0,n.jsx)("div",{className:"bg-pink-accent h-2 rounded-full transition-all duration-500",style:{width:"".concat(p,"%")}})}),(0,n.jsxs)("div",{className:"flex items-center justify-center space-x-6",children:[(0,n.jsx)("button",{onClick:u,className:"p-3 bg-pink-light text-pink-primary rounded-full hover:bg-pink-secondary hover:text-white",children:(0,n.jsx)(l.r7n,{size:24})}),(0,n.jsx)("button",{onClick:()=>{j.current?x?(j.current.pauseVideo(),a()):(j.current.playVideo(),i()):(x?a():i(),m(!x))},className:"p-5 bg-pink-primary text-white rounded-full hover:bg-pink-accent transform hover:scale-105 transition-all",disabled:!g&&!t.videoId,children:x?(0,n.jsx)(l.kwt,{size:32}):(0,n.jsx)(l.gSK,{size:32})}),(0,n.jsx)("button",{onClick:d,className:"p-3 bg-pink-light text-pink-primary rounded-full hover:bg-pink-secondary hover:text-white",children:(0,n.jsx)(l.LxX,{size:24})})]}),r&&(0,n.jsxs)("div",{className:"mt-8 text-center",children:[(0,n.jsx)("p",{className:"text-sm text-pink-dark",children:"Next up"}),(0,n.jsx)("p",{className:"text-lg font-semibold text-pink-primary",children:r.title}),r.artist&&(0,n.jsx)("p",{className:"text-sm text-pink-dark",children:r.artist})]})]})})}let x=[{icon:"star",component:(0,n.jsx)(l.gt3,{size:32})},{icon:"heart",component:(0,n.jsx)(l.Mbv,{size:32})},{icon:"magic",component:(0,n.jsx)(l.T_n,{size:32})},{icon:"cat",component:(0,n.jsx)(l.KOd,{size:32})},{icon:"dog",component:(0,n.jsx)(l.OL8,{size:32})},{icon:"icecream",component:(0,n.jsx)(l.jOg,{size:32})}],m=e=>{let t=x.find(t=>t.icon===e);return t?t.component:(0,n.jsx)(l.gt3,{size:32})};function p(e){let{playlists:t=[],onSelectPlaylist:r,currentPlaylistId:l}=e,[i,a]=(0,s.useState)(!1);return(0,n.jsxs)("div",{className:"mt-8 w-full max-w-lg mx-auto",children:[(0,n.jsxs)("button",{onClick:()=>a(!i),className:"w-full bg-pink-light p-4 rounded-xl mb-4 text-pink-accent font-bold flex items-center justify-center",children:[(0,n.jsxs)("span",{className:"mr-2",children:[i?"Hide":"Choose"," Playlists"]}),(0,n.jsx)("span",{children:i?"▲":"▼"})]}),i&&(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4 mt-2 transition-all duration-300",children:[t.map(e=>(0,n.jsxs)("button",{onClick:()=>{r(e),a(!1)},className:"\n                flex flex-col items-center justify-center p-5 rounded-xl transition-all\n                ".concat(l===e.id?"bg-pink-primary text-white":"bg-white hover:bg-pink-light text-pink-dark","\n              "),children:[(0,n.jsx)("div",{className:"mb-3",children:m(e.icon)}),(0,n.jsx)("p",{className:"font-bold text-center",children:e.name})]},e.id)),0===t.length&&(0,n.jsxs)("div",{className:"col-span-2 text-center p-8 bg-white rounded-xl",children:[(0,n.jsx)("p",{className:"text-pink-dark",children:"No playlists added yet!"}),(0,n.jsx)("p",{className:"text-sm mt-2",children:"Ask a grown-up to add some for you."})]})]})]})}function h(){let[e,t]=(0,s.useState)([]),[r,i]=(0,s.useState)(null),[a,c]=(0,s.useState)(0),[d,x]=(0,s.useState)([]),[m,h]=(0,s.useState)(!0);(0,s.useEffect)(()=>{(async()=>{try{let e=await o.R.getPlaylists();t(e),e.length>0&&i(e[0]),h(!1)}catch(e){console.error("Failed to load playlists:",e),h(!1)}})()},[]),(0,s.useEffect)(()=>{let e=async()=>{if(r)try{h(!0);let e=await o.R.getSongsForPlaylist(r.id);x(e),c(0),h(!1)}catch(e){console.error("Failed to load songs:",e),h(!1)}};r&&e()},[null==r?void 0:r.id]);let g=()=>{if(d.length>0){let e=d[a];o.R.playSong(e.videoId)}},f=d.length>0?d[a]:void 0,y=d.length>0?d[(a+1)%d.length]:void 0;return(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center py-8 px-4 max-w-3xl mx-auto",children:[(0,n.jsxs)("h1",{className:"text-4xl font-bold text-pink-accent mb-8 flex items-center",children:[(0,n.jsx)(l.BHn,{className:"mr-2"})," BittyBox ",(0,n.jsx)(l.Mbv,{className:"ml-2 text-pink-primary"})]}),m?(0,n.jsxs)("div",{className:"text-center p-12",children:[(0,n.jsx)("div",{className:"w-16 h-16 border-4 border-pink-primary border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,n.jsx)("p",{className:"text-pink-dark",children:"Loading your music..."})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u,{currentSong:f,nextSong:y,onPlay:g,onPause:g,onNext:()=>{d.length>0&&c((a+1)%d.length)},onPrevious:()=>{d.length>0&&c((a-1+d.length)%d.length)}}),(0,n.jsx)(p,{playlists:e,onSelectPlaylist:e=>{i(e)},currentPlaylistId:null==r?void 0:r.id})]}),(0,n.jsxs)("footer",{className:"mt-10 text-center text-sm text-pink-dark",children:[(0,n.jsx)("p",{children:"BittyBox - Made with love for little music lovers \uD83D\uDC96"}),(0,n.jsx)("button",{className:"text-xs mt-2 text-gray-400 hover:text-pink-dark",onClick:()=>{window.location.href="/settings"},children:"Grown-Up Settings"})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[711,108,831,441,684,358],()=>t(634)),_N_E=e.O()}]);